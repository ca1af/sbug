# 실시간 채팅_웹소켓

## 1️⃣ 처음 실시간 채팅 기능 구현을 위해서 고민했던 방법들과 선택에 대한 이유
1. 폴링(polling) 방식을 이용한 구현
   - 폴링 방식은 클라이언트가 정해진 시간 간격으로 서버에 요청을 보내서 응답을 받는 방식입니다.<br>서버 측에서 보낼 내용이 없어도 클라이언트는 계속해서 요청을 보내 확인하기 때문에 서버의 부담이 증가하고, 시간 간격에 따라서는 실시간이라고 보기 어렵다는 단점이 있었습니다.

2. 웹 소켓 방식을 이용한 구현 ✅
   - 웹 소켓 방식은 클라이언트와 서버가 양방향 연결 채널을 구성하기 때문에 클라이언트의 요청이 없어도 서버에서 데이터를 송신하는 것이 가능합니다.<br>
 서버가 보내야 될 데이터가 있으면 서버에서 바로 데이터를 보내주기 때문에 폴링 방식에서의 단점을 극복할 수 있다고 생각하여 선택했습니다.<br>(다만 웹 소켓은 네트워크 자원을 많이 사용한다는 단점이 있었습니다.)
 
## 2️⃣ 실시간 채팅_STOMP
STOMP는 기본적으로 publish, subscribe 구조 메세지를 전송하고 메세지를 받아 처리하는 부분이 확실히 정해져 있습니다.
메세지의 헤더에 값을 줄 수 있어 인증 처리를 구현하는 것이 가능하고 스프링 프레임워크에서 사용이 편리합니다.

## 3️⃣ 실시간 채팅_SOCK JS
웹 소켓을 사용하는데 고려해야 할 점으로 아래와 같은 문제가 있습니다.
1. 모든 브라우저에서 웹 소켓을 지원한다는 보장이 없다
2. 서버와 클라이언트의 중간에 Proxy가 헤더를 해석하지 못해 서버에 메세지를 전달하지 못하거나 connection을 종료 시켜버릴 수 있다.<br>

      ☑️ 이런 문제들을 해결하기 위해서 websocket emulation을 사용합니다.<br>이것은 우선 웹 소켓 통신을 시도하고, 실패할 경우 http 기반의 다른 기술(polling 등)로 전환해 다시 연결을 시도하는 것을 말합니다.<br>spring에서는 sock js를 사용하는 것이 일반적이며 웹 소켓 설정 파일(configuration)에 몇 글자만 덧붙이는 것으로 간단하게 사용할 수 있습니다.
